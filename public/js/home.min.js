function initFirma(){window.crypto.enableSmartCardEvents=!0,document.addEventListener("smartcard-insert",cardIn,!1),document.addEventListener("smartcard-remove",cardOut,!1)}function terminateFirma(){document.removeEventListener("smartcard-insert",cardIn,!1),document.removeEventListener("smartcard-remove",cardOut,!1)}function cardIn(e){alert("CARD IN"),tempPid=e.tokenName,$("#loginFirma .alert").addClass("alert-success"),$("#loginFirma .alert").text("Su tarjeta est√° conectada correctamente. Puede continuar."),$("#loginFirma .btn").removeAttr("disabled")}function cardOut(){alert("CARD OUT"),$("#loginFirma .alert").removeClass("alert-success"),$("#loginFirma .alert").text("Primero debe conectar su tarjeta para continuar."),$("#loginFirma .btn").attr({disabled:"disabled"})}function validate(){return crypto.version!==void 0&&(crmfObject=crypto.generateCRMFRequest("CN=ULATINA Componentes - Certificado Firma Digital ",tempPid,authenticator,keyTransportCert,"setCRMFRequest();",1024,null,"rsa-dual-use")),!1}function setCRMFRequest(){$("#loginFirma form").find("input[name=cert_request]").val(crmfObject.request),$("#loginFirma form").submit()}var authenticator="server_magic",keyTransportCert=null,crmfObject=null,tempPid;jQuery(document).ready(function(){}),jQuery(window).load(function(){initFirma(),$("#loginFirma form").submit(validate)}),jQuery(window).unload(function(){terminateFirma()});
